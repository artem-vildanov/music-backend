import{_,f as d,o as c,c as p,b as s,w as P,v as I,d as h,p as v,e as g,r as y,F as w,k as $,i as b,l as k}from"./index-BCrCh3O-.js";import{P as C}from"./PlaylistCard--LevWLeD.js";import{_ as F}from"./create-CM7SjTAk.js";const B={name:"CreatePlaylist",data(){return{playlistName:"",imageFile:null}},mounted(){this.imageInputPreview()},methods:{buttonClickabilityChecker(){return this.playlistName!==""},imageInputPreview(){const t=document.getElementById("imageInput"),e=document.getElementById("imagePreview");t.addEventListener("change",a=>{this.imageFile=a.target.files[0],e.src=URL.createObjectURL(this.imageFile)})},async createPlaylist(){const t=await this.sendCreateAlbumRequest();await this.sendSetPlaylistPhotoRequest(t),await this.displayCreatedPlaylist(t),this.hideModal()},async sendCreateAlbumRequest(){const t={name:this.playlistName};return(await d.post("http://music.local/api/playlists/create-playlist",t)).data.playlistId},async sendSetPlaylistPhotoRequest(t){if(this.imageFile){const e=this.makeImageFormData(),a=`http://music.local/api/playlists/${t}/update-playlist-photo`;await d.post(a,e)}},makeImageFormData(){const t=new FormData;return t.append("photo",this.imageFile),t},async displayCreatedPlaylist(t){const e=`http://music.local/api/playlists/${t}`,i=(await d.get(e)).data;this.$parent.$data.userPlaylists.push(i)},hideModal(){this.$parent.hideModal()}}},r=t=>(v("data-v-f968ea72"),t=t(),g(),t),E={class:"create-playlist"},M=r(()=>s("div",{class:"title"}," Создать новый плейлист ",-1)),L={id:"playlistForm",class:"input-fields-container"},D=r(()=>s("label",{for:"imageInput",class:"input-fields-container__file-input-label"},"Выбрать обложку",-1)),N=r(()=>s("input",{id:"imageInput",type:"file",accept:"image/png",class:"input-fields-container__file-input"},null,-1)),U=r(()=>s("img",{id:"imagePreview",src:"",class:"input-fields-container__input-image"},null,-1)),x=["disabled"];function R(t,e,a,i,l,o){return c(),p("div",E,[M,s("div",L,[P(s("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>l.playlistName=n),placeholder:"Название плейлиста",type:"text",class:"input-fields-container__playlist-name"},null,512),[[I,l.playlistName]]),D,N,U]),s("input",{type:"submit",disabled:!o.buttonClickabilityChecker(),onClick:e[1]||(e[1]=h(n=>o.createPlaylist(),["prevent"])),class:"submit-button",value:"Создать"},null,8,x)])}const S=_(B,[["render",R],["__scopeId","data-v-f968ea72"]]),q={name:"UserPlaylists",components:{PlaylistCard:C,CreatePlaylist:S},data(){return{userPlaylists:null}},mounted(){this.getUserPlaylists()},methods:{getUserPlaylists(){d.get("http://music.local/api/playlists").then(t=>{this.userPlaylists=t.data})},openModalWindow(){const t=document.getElementById("modal");t.style.visibility="visible",t.style.opacity="1",setTimeout(()=>{this.overlayClickListener()},500)},overlayClickListener(){document.getElementById("overlay").addEventListener("click",this.hideModal)},hideModal(){const t=document.getElementById("modal"),e=document.getElementById("overlay");t.style.visibility="hidden",t.style.opacity="0",e.removeEventListener("click",this.hideModal)}}},m=t=>(v("data-v-c6a15f62"),t=t(),g(),t),V={class:"user-playlists"},j={class:"header"},A=m(()=>s("div",{class:"header__title"}," Ваши плейлисты ",-1)),T=m(()=>s("img",{src:F,class:"icon"},null,-1)),W=[T],O={class:"playlists"},z={class:"modal",id:"modal"},G=m(()=>s("div",{class:"modal__overlay",id:"overlay"},null,-1)),H={class:"modal__window"};function J(t,e,a,i,l,o){const n=y("playlist-card"),f=y("create-playlist");return c(),p("div",V,[s("div",j,[A,s("div",{onClick:e[0]||(e[0]=h(u=>o.openModalWindow(),["prevent"])),title:"Создать новый плейлист",class:"header__create-new"},W)]),s("div",O,[(c(!0),p(w,null,$(l.userPlaylists,u=>(c(),k(n,{playlist:u},null,8,["playlist"]))),256))]),s("div",z,[G,s("div",H,[b(f)])])])}const Y=_(q,[["render",J],["__scopeId","data-v-c6a15f62"]]);export{Y as default};
